{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["file:///Users/monz/Code/queue/frontend/src/app/page.js"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { io } from 'socket.io-client';\nimport Quagga from \"quagga\"; \n\nconst socket = io('http://192.168.1.207:5000');\n\nfunction App() {\n  const [preparingTasks, setPreparingTasks] = useState([]);\n  const [finishedTasks, setFinishedTasks] = useState([]);\n  const [formData, setFormData] = useState({ category: 'BK', number: '' });\n  const [barcode, setBarcode] = useState(\"\"); // State to store the scanned barcode\n  const [isScanning, setIsScanning] = useState(false); // State to toggle scanning\n\n  useEffect(() => {\n    loadTasks();\n\n    socket.on('update_tasks', (data) => {\n      setPreparingTasks(data.preparing);\n      setFinishedTasks(data.finished);\n    });\n\n    return () => {\n      socket.disconnect(); // Clean up on unmount\n    };\n  }, []);\n\n  const loadTasks = async () => {\n    const response = await axios.get('http://192.168.1.207:5000/tasks');\n    setPreparingTasks(response.data.preparing);\n    setFinishedTasks(response.data.finished);\n  };\n\n  const handleChange = (e) => {\n    setFormData({ ...formData, [e.target.name]: e.target.value });\n  };\n\n  const startScanning = () => {\n    setIsScanning(true);\n    Quagga.init(\n      {\n        inputStream: {\n          name: \"Live\",\n          type: \"LiveStream\",\n          target: document.querySelector(\"#barcode-scanner\"), // The DOM element to show the camera feed\n          constraints: {\n            width: 640,\n            height: 480,\n            facingMode: \"environment\", // Use the rear camera\n          },\n        },\n        decoder: {\n          readers: [\"code_128_reader\", \"ean_reader\", \"ean_8_reader\"], // Add more readers if needed\n        },\n      },\n      (err) => {\n        if (err) {\n          console.error(\"Error initializing Quagga:\", err);\n          setIsScanning(false);\n          return;\n        }\n        Quagga.start();\n      }\n    );\n\n    Quagga.onDetected((data) => {\n      if (data && data.codeResult && data.codeResult.code) {\n        setBarcode(data.codeResult.code); // Set the scanned barcode\n        stopScanning(); // Stop scanning after detecting a barcode\n      }\n    });\n  };\n\n  const stopScanning = () => {\n    Quagga.stop();\n    setIsScanning(false);\n  };\n\n  const sendBarcodeToBackend = async () => {\n    if (!barcode) {\n      alert(\"No barcode scanned.\");\n      return;\n    }\n\n    try {\n      const response = await axios.post(\"http://192.168.1.207:5000/upload\", { barcode });\n      alert(`Price for barcode ${barcode}: ${response.data.price}`);\n    } catch (error) {\n      console.error(\"Error sending barcode to backend:\", error);\n      alert(\"Failed to process the barcode.\");\n    }\n  };\n\n  const addTask = async () => {\n    if (!formData.category || !formData.number) {\n      alert('Please fill out all fields.');\n      return;\n    }\n    await axios.post('http://192.168.1.207:5000/tasks', formData);\n    setFormData({ category: 'BK', number: '' });\n  };\n\n  const finishTask = async (taskId) => {\n    await axios.post('http://192.168.1.207:5000/tasks/finish', { task_id: taskId });\n  };\n\n  // Safely sort finished tasks by finished_at time (latest first)\n  const sortedFinishedTasks = finishedTasks?.length\n    ? finishedTasks.sort((a, b) => {\n        const dateA = new Date(a.finished_at);\n        const dateB = new Date(b.finished_at);\n        return dateB - dateA; // descending order\n      })\n    : [];\n  return (\n    <div className=\"min-h-screen bg-gray-100 p-6\">\n      <h2 className=\"text-4xl font-bold mb-6 text-center text-red-600\">Queue System</h2>\n\n      {/* âœ… Add Task Form */}\n      <div className=\"max-w-4xl mx-auto bg-white p-6 rounded-lg shadow-md mb-8\">\n        <h3 className=\"text-2xl font-semibold mb-4 text-gray-700\">âž• Add Order</h3>\n        <div className=\"flex gap-4\">\n          <select\n            name=\"category\"\n            value={formData.category}\n            onChange={handleChange}\n            className=\"border rounded-lg p-3 w-full\"\n          >\n            <option value=\"BK\">BK</option>\n            <option value=\"CS\">CS</option>\n          </select>\n          <input\n            type=\"text\"\n            name=\"number\"\n            value={formData.number}\n            onChange={handleChange}\n            placeholder=\"enter number\"\n            className=\"border rounded-lg p-3 w-full\"\n          />\n          <button\n            onClick={addTask}\n            className=\"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition\"\n          >\n            Add Task\n          </button>\n        </div>\n      </div>\n\n      <div className=\"max-w-4xl mx-auto bg-white p-6 rounded-lg shadow-md mb-8\">\n        <h3 className=\"text-2xl font-semibold mb-4 text-gray-700\">ðŸ“· Barcode Scanner</h3>\n        <div id=\"barcode-scanner\" className=\"w-full h-64 bg-gray-200 rounded-lg mb-4\"></div>\n        {isScanning ? (\n          <button\n            onClick={stopScanning}\n            className=\"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition\"\n          >\n            Stop Scanning\n          </button>\n        ) : (\n          <button\n            onClick={startScanning}\n            className=\"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition\"\n          >\n            Start Scanning\n          </button>\n        )}\n        {barcode && (\n          <div className=\"mt-4\">\n            <p className=\"text-lg text-gray-700\">\n              <strong>Scanned Barcode:</strong> {barcode}\n            </p>\n            <button\n              onClick={sendBarcodeToBackend}\n              className=\"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition mt-2\"\n            >\n              Send to Backend\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* âœ… Side-by-Side Queue Display */}\n      <div className=\"grid grid-cols-2 gap-6\">\n        {/* ðŸŸ¡ Preparing Queue */}\n        <div className=\"bg-yellow-50 p-6 rounded-lg shadow-md\">\n          <h3 className=\"text-2xl font-semibold mb-4 text-yellow-700\">ðŸ•’ Preparing Queue</h3>\n          <div className=\"grid grid-cols-2 gap-4 overflow-y-auto max-h-[500px]\">\n            {preparingTasks?.map((task, index) => (\n              <div key={index} className=\"bg-white border rounded-lg p-4 shadow-md flex justify-between items-center\">\n                <div>\n                  <span className=\"block font-bold text-xl\">{`${task.category}${task.number}`}</span>\n                  <span className=\"block text-sm text-gray-400\">\n                    Created at: {new Date(task.created_at).toLocaleString()}\n                  </span>\n                </div>\n                <button\n                  onClick={() => finishTask(task.task_id)}\n                  className=\"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition\"\n                >\n                  âœ… Finish\n                </button>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* âœ… Finished Queue */}\n        <div className=\"bg-green-50 p-6 rounded-lg shadow-md\">\n          <h3 className=\"text-2xl font-semibold mb-4 text-green-700\">âœ… Finished Queue</h3>\n          <div className=\"grid grid-cols-2 gap-4 overflow-y-auto max-h-[500px]\">\n            {sortedFinishedTasks?.map((task, index) => (\n              <div key={index} className=\"bg-white border rounded-lg p-4 shadow-md\">\n                <div>\n                  <span className=\"block font-bold text-xl\">{`${task.category}${task.number}`}</span>\n                  <span className=\"block text-sm text-gray-400\">\n                    Created at: {new Date(task.created_at).toLocaleString()}\n                  </span>\n                  <span className=\"block text-sm text-gray-400\">\n                    Finished at: {task.finished_at ? new Date(task.finished_at).toLocaleString() : 'Not finished'}\n                  </span>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 600, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}